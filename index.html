<html>
<body>
<script src="triMath.js"></script>

<div style="width:100%">
	<div style = "margin:10px; clear: none; float: left;">
		Draw
		</br>
		<canvas id="canvas" width="300" height="300" style="border:1px solid #000000;"> </canvas>
	</div>
	<div style = "margin:10px; clear: none; float: left;">
		No reduction
		</br>
		<canvas id="canvas2" width="300" height="300" style="border:1px solid #000000;"> </canvas>
	</div>
	<div style = "margin:10px; clear: none; float: left;">
		Douglas-Peucker
		</br>
		<canvas id="canvas3" width="300" height="300" style="border:1px solid #000000;"> </canvas>
		</br>
		</br>
		
		<form><input type="range" min=0 max=10 id="epsilon" step=0.1 value=4></input><label id="epLabel" value="">aaaa</label></form>
		
	</div>

	<div style = "margin:10px; clear: none; float: left;">
		Visvalingam-Whyatt
		</br>
		<canvas id="canvas4" width="300" height="300" style="border:1px solid #000000;"> </canvas>
		</br>
		</br>
		
		<form><input type="range" min=0 max=1 id="percent" step=0.01 value=1></input><label id="percentLabel" value="">aaaa</label></form>
		
	</div>
</div>

<script type="text/javascript">

var canvas = document.getElementById('canvas');
var context = canvas.getContext("2d");

var canvas2 = document.getElementById('canvas2');
var context2 = canvas2.getContext("2d");

var canvas3 = document.getElementById('canvas3');
var context3 = canvas3.getContext("2d");

var canvas4 = document.getElementById('canvas4');
var context4 = canvas4.getContext("2d");

var rect = canvas.getBoundingClientRect();

var drawnPolygon = [];
var mousePoint = new Point(0,0);
var mousedown = false;


var epsilonSlider = document.getElementById('epsilon');
var epsilonLabel = document.getElementById('epLabel');


var percentSlider = document.getElementById('percent');
var percentLabel = document.getElementById('percentLabel');


var canDraw = true;

function tick(){

	if (mousedown && canDraw){
		if (drawnPolygon.length == 0){
			drawnPolygon.push(new Point(mousePoint.x,mousePoint.y));
		}
		if (dist(mousePoint,drawnPolygon[drawnPolygon.length-1]) > 10){
			drawnPolygon.push(new Point(mousePoint.x,mousePoint.y));
		}
	}

	if (drawnPolygon.length > 1){
		draw(context,drawnPolygon,false);
		draw(context2,drawnPolygon,true);
		draw(context3,douglasPeucker(drawnPolygon,epsilonSlider.value),true);
		draw(context4,visvalingamWhyatt(drawnPolygon,percentSlider.value),true);
	}
	epsilonLabel.innerHTML = "Epsilon: "+epsilonSlider.value;
	percentLabel.innerHTML = "Percent: "+percentSlider.value;
}


function draw(ctx, arr, drawPoints){
	ctx.clearRect(0,0,400,400);
	
	ctx.strokeStyle = "#00000";
	ctx.beginPath();
	ctx.moveTo(arr[0].x,arr[0].y);
	if (arr.length > 2){
		for (var i = 1; i < arr.length; i++){
			ctx.lineTo(arr[i].x,arr[i].y);
		}
		if (mousedown && canDraw){
			ctx.lineTo(mousePoint.x,mousePoint.y);
		}else{
			ctx.lineTo(arr[0].x,arr[0].y);
		}
	}
	ctx.stroke();

	if(drawPoints){
		ctx.fillStyle = "#ff0000";
		for (var i = 0; i < arr.length; i++){
			ctx.fillRect(arr[i].x-2,arr[i].y-2,5,5);
		}
	}
}

function drawLine(p1,p2){
    ctx.beginPath();
    ctx.moveTo(p1.x,p1.y);
    ctx.lineTo(p2.x,p2.y);
    ctx.stroke();
}

canvas.addEventListener('mousemove', function(evt) {
    mousePoint.x = evt.clientX - rect.left;
    mousePoint.y = evt.clientY - rect.top;
  }, false);

canvas.addEventListener('mousedown', function(evt) {
    mousedown = true;
  }, false);

canvas.addEventListener('mouseup', function(evt) {
    mousedown = false;
    canDraw = false;
  }, false);

tick();
setInterval(tick,16);


</script>




</body>
</html>


<html>
<head>
